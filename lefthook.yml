pre-commit:
  commands:
    bump_versions:
      glob: "**/PKGBUILD"
      stage_fixed: true
      run: |
        sd "pkgver=.+" "pkgver=$(date '+%Y.%m.%d')+$(git rev-parse --short HEAD)" {staged_files}

    update_srcinfo:
      glob: "**/PKGBUILD"
      run: |
        for f in {staged_files}; do
          pushd $(dirname $f)
          makepkg --printsrcinfo > .SRCINFO
          git add .SRCINFO
          popd
        done

    format_fish_scripts:
      files: rg --files-with-matches --line-regexp "#!/usr/bin/env fish"
      run: fish_indent --write {files}
